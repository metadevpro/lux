<div class="lux-geolocation" [id]="inputId">
  <input
    #latitude
    class="prefix"
    type="number"
    [id]="inputId + '$latitude'"
    [attr.value]="latitudeValue"
    [attr.aria-label]="ariaLabel"
    [attr.disabled]="(disabled !== undefined && disabled !== null) ? disabled : null"
    [attr.readonly]="(readonly !== undefined && readonly !== null) ? readonly : null"
    [attr.min]="(minLatitude !== undefined && minLatitude !== null) ? minLatitude : null"
    [attr.max]="(maxLatitude !== undefined && maxLatitude !== null) ? maxLatitude : null"
    [attr.step]="(step !== undefined && step !== null) ? step : null"
    placeholder="lat"
    [ngClass]="className"
    (focus)="markAsTouched()"
    (keyup)="onKeyUpLatitude(latitude.value)"
    (change)="onChangeLatitude(latitude.value)"
    (keypress)="onKeyPress($event)"
  />
  <div class="infix symbol">
    <span *ngIf="latitudeValue >= 0" >N</span>
	<span *ngIf="latitudeValue < 0" >S</span>
  </div>
  <input
    #longitude
    class="infix"
    type="number"
    [id]="inputId + '$longitude'"
    [attr.value]="longitudeValue"
    [attr.aria-label]="ariaLabel"
    [attr.disabled]="(disabled !== undefined && disabled !== null) ? disabled : null"
    [attr.readonly]="(readonly !== undefined && readonly !== null) ? readonly : null"
    [attr.min]="(minLongitude !== undefined && minLongitude !== null) ? minLongitude : null"
    [attr.max]="(maxLongitude !== undefined && maxLongitude !== null) ? maxLongitude : null"
    [attr.step]="(step !== undefined && step !== null) ? step : null"
    placeholder="lon"
    [ngClass]="className"
    (focus)="markAsTouched()"
    (keyup)="onKeyUpLongitude(longitude.value)"
    (change)="onChangeLongitude(longitude.value)"
    (keypress)="onKeyPress($event)"
  />
  <div class="infix symbol">
    <span *ngIf="longitudeValue >= 0">E</span>
    <span *ngIf="longitudeValue < 0">W</span>
  </div>
  <button class="postfix" (click)="openModal(modalMap)">
    <span>üåê</span>
  </button>
</div>

<div *ngIf="inlineErrors && lastErrors && (dirty || touched)" class="alert">
  <div *ngIf="lastErrors.required">
    {{ userErrors[this.lang].required }}
  </div>
  <div *ngIf="lastErrors.minLatitude">
    {{ userErrors[this.lang].minLatitude.replace('$minLatitude', lastErrors.minLatitude.min) }}
  </div>
  <div *ngIf="lastErrors.maxLatitude">
    {{ userErrors[this.lang].maxLatitude.replace('$maxLatitude', lastErrors.maxLatitude.max) }}
  </div>
  <div *ngIf="lastErrors.minLongitude">
    {{ userErrors[this.lang].minLongitude.replace('$minLongitude', lastErrors.minLongitude.min) }}
  </div>
  <div *ngIf="lastErrors.maxLongitude">
    {{ userErrors[this.lang].maxLongitude.replace('$maxLongitude', lastErrors.maxLongitude.max) }}
  </div>
</div>

<ng-template #modalMap let-modal>
  <div class="lux-modal-header">
    <h4 class="modal-title" id="modal-basic-title">Map</h4>
    <button
      type="button"
      class="close"
      aria-label="Close"
      (click)="modal.dismiss('Cross click')"
    >
      <span aria-hidden="true">√ó</span>
    </button>
  </div>
  <div class="lux-modal-body">
    <lux-map #map [longitude]="longitudeValue" [latitude]="latitudeValue"> </lux-map>
  </div>
  <div class="lux-modal-footer">
    <button
      type="button"
      class="btn btn-outline-dark"
      (click)="modal.close({latitude:map.latitude, longitude:map.longitude})"
    >
      Select
    </button>
  </div>
</ng-template>
